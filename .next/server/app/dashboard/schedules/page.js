(()=>{var e={};e.id=446,e.ids=[446,181],e.modules={5403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},4749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},5528:e=>{"use strict";e.exports=require("next/dist\\client\\components\\action-async-storage.external.js")},1877:e=>{"use strict";e.exports=require("next/dist\\client\\components\\request-async-storage.external.js")},5319:e=>{"use strict";e.exports=require("next/dist\\client\\components\\static-generation-async-storage.external.js")},4300:e=>{"use strict";e.exports=require("buffer")},6113:e=>{"use strict";e.exports=require("crypto")},2361:e=>{"use strict";e.exports=require("events")},3685:e=>{"use strict";e.exports=require("http")},5687:e=>{"use strict";e.exports=require("https")},1808:e=>{"use strict";e.exports=require("net")},4577:e=>{"use strict";e.exports=require("punycode")},2781:e=>{"use strict";e.exports=require("stream")},4404:e=>{"use strict";e.exports=require("tls")},7310:e=>{"use strict";e.exports=require("url")},3837:e=>{"use strict";e.exports=require("util")},9796:e=>{"use strict";e.exports=require("zlib")},8359:()=>{},3739:()=>{},7327:(e,s,t)=>{"use strict";t.r(s),t.d(s,{GlobalError:()=>i.a,__next_app__:()=>u,originalPathname:()=>x,pages:()=>c,routeModule:()=>h,tree:()=>n});var a=t(7096),r=t(6132),l=t(7284),i=t.n(l),d=t(2564),o={};for(let e in d)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>d[e]);t.d(s,o);let n=["",{children:["dashboard",{children:["schedules",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,6793)),"C:\\Users\\tribeiro\\Documents\\church-schedule-app\\church-schedule-app\\app\\dashboard\\schedules\\page.tsx"]}]},{}]},{}]},{layout:[()=>Promise.resolve().then(t.bind(t,5345)),"C:\\Users\\tribeiro\\Documents\\church-schedule-app\\church-schedule-app\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(t.t.bind(t,9291,23)),"next/dist/client/components/not-found-error"]}],c=["C:\\Users\\tribeiro\\Documents\\church-schedule-app\\church-schedule-app\\app\\dashboard\\schedules\\page.tsx"],x="/dashboard/schedules/page",u={require:t,loadChunk:()=>Promise.resolve()},h=new a.AppPageRouteModule({definition:{kind:r.x.APP_PAGE,page:"/dashboard/schedules/page",pathname:"/dashboard/schedules",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:n}})},6677:(e,s,t)=>{Promise.resolve().then(t.bind(t,7509))},7509:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>SchedulesPage});var a=t(784),r=t(9885),l=t(1440),i=t.n(l),d=t(6568);let o={draft:"bg-yellow-500/20 text-yellow-200 border-yellow-300/40",published:"bg-emerald-500/20 text-emerald-100 border-emerald-300/40"};function SchedulesPage(){let[e,s]=(0,r.useState)([]),[t,l]=(0,r.useState)(()=>{let e=new Date;return`${e.getFullYear()}-${String(e.getMonth()+1).padStart(2,"0")}`}),[n,c]=(0,r.useState)(!1),[x,u]=(0,r.useState)(null),[h,p]=(0,r.useState)(null),[m,b]=(0,r.useState)(null),g=(0,r.useCallback)(async()=>{let{data:e,error:t}=await d.O.from("schedule_runs").select("*").order("year",{ascending:!1}).order("month",{ascending:!1});if(t){p(t.message);return}s(e??[])},[]);(0,r.useEffect)(()=>{g()},[g]);let f=(0,r.useMemo)(()=>e.reduce((e,s)=>(e[s.year]||(e[s.year]=[]),e[s.year].push(s),e),{}),[e]);async function handleGenerate(){if(!t)return;c(!0),p(null),b(null);let e=await fetch(`/api/schedules/generate?month=${t}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({})}),s=await e.json();e.ok?(b("Escala gerada com sucesso! Reveja os detalhes antes de publicar."),await g()):p(s.error||"Erro ao gerar nova escala. Revise suas permiss\xc3\xb5es ou tente novamente."),c(!1)}async function publish(e){u(e),p(null),b(null);let s=await fetch("/api/schedules/publish",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:e})}),t=await s.json();s.ok?(b("Escala publicada! As equipes j\xc3\xa1 podem consultar no painel."),await g()):p(t.error||"N\xc3\xa3o foi poss\xc3\xadvel publicar a escala."),u(null)}return a.jsx("div",{className:"min-h-screen bg-slate-950 bg-gradient-to-br from-slate-900 via-slate-950 to-indigo-950 text-slate-100",children:(0,a.jsxs)("div",{className:"mx-auto flex max-w-6xl flex-col gap-10 px-6 py-12",children:[(0,a.jsxs)("header",{className:"relative overflow-hidden rounded-3xl border border-white/10 bg-white/5 p-10 shadow-xl shadow-indigo-900/20 backdrop-blur",children:[a.jsx("div",{className:"absolute -left-10 top-1/2 h-40 w-40 -translate-y-1/2 rounded-full bg-sky-500/20 blur-3xl"}),a.jsx("div",{className:"absolute -right-14 -top-12 h-40 w-40 rounded-full bg-indigo-400/20 blur-3xl"}),(0,a.jsxs)("div",{className:"relative flex flex-col gap-4 md:flex-row md:items-center md:justify-between",children:[(0,a.jsxs)("div",{children:[a.jsx("p",{className:"text-xs uppercase tracking-[0.35em] text-sky-200/80",children:"Governan\xc3\xa7a ministerial"}),a.jsx("h1",{className:"mt-2 text-3xl font-black md:text-4xl",children:"\xf0Ÿ“‹ Escalas & equipes"}),a.jsx("p",{className:"mt-4 max-w-2xl text-sm text-sky-100/80",children:"Controle completo de escalas mensais: gere novas vers\xc3\xb5es, publique para a igreja e exporte materiais personalizados para cada equipe."})]}),(0,a.jsxs)("div",{className:"flex flex-col gap-3 text-sm text-sky-100/80",children:[a.jsx(i(),{href:"/dashboard",className:"inline-flex items-center gap-2 self-start rounded-full border border-white/10 bg-white/10 px-4 py-2 font-semibold transition hover:bg-white/20",children:"\xe2†\x90 Voltar ao painel"}),a.jsx("span",{className:"rounded-full border border-sky-200/30 bg-sky-500/20 px-4 py-2 font-semibold text-sky-100",children:"\xf0Ÿš€ Organiza\xc3\xa7\xc3\xa3o que inspira confian\xc3\xa7a"})]})]})]}),(h||m)&&(0,a.jsxs)("div",{className:"rounded-2xl border border-white/10 bg-white/10 p-4 text-sm",children:[h&&(0,a.jsxs)("p",{className:"text-rose-200",children:["\xe2š\xa0\xef\xb8\x8f ",h]}),m&&(0,a.jsxs)("p",{className:"text-emerald-200",children:["\xe2œ… ",m]})]}),a.jsx("section",{className:"rounded-3xl border border-white/10 bg-white/5 p-8 shadow-lg shadow-indigo-900/20",children:(0,a.jsxs)("div",{className:"flex flex-col gap-4 md:flex-row md:items-end md:justify-between",children:[(0,a.jsxs)("div",{children:[a.jsx("h2",{className:"text-2xl font-semibold text-white",children:"Gerar nova escala"}),a.jsx("p",{className:"mt-2 text-sm text-sky-100/80",children:"Escolha o m\xc3\xaas desejado no formato ano-m\xc3\xaas e gere uma nova escala baseada nas disponibilidades atuais."})]}),(0,a.jsxs)("div",{className:"flex flex-col gap-3 text-sm md:flex-row md:items-center",children:[(0,a.jsxs)("label",{className:"flex flex-col gap-2 text-sky-100/80",children:["M\xc3\xaas (YYYY-MM)",a.jsx("input",{type:"month",value:t,onChange:e=>l(e.target.value),className:"rounded-xl border border-white/10 bg-slate-900/60 px-4 py-3 text-sm text-white shadow-inner shadow-black/40 focus:border-indigo-300/60 focus:outline-none focus:ring-2 focus:ring-indigo-400/40"})]}),a.jsx("button",{type:"button",disabled:n||!t,onClick:handleGenerate,className:"inline-flex items-center gap-2 rounded-full border border-indigo-300/40 bg-indigo-500/80 px-6 py-3 text-sm font-semibold text-white shadow-lg shadow-indigo-900/30 transition hover:bg-indigo-400 disabled:cursor-not-allowed disabled:border-white/10 disabled:bg-white/10 disabled:text-indigo-100/60",children:n?"Processando...":"\xe2œ\xa8 Gerar escala"})]})]})}),(0,a.jsxs)("section",{className:"rounded-3xl border border-white/10 bg-white/5 p-8 shadow-lg shadow-indigo-900/20",children:[(0,a.jsxs)("div",{className:"flex flex-col gap-2",children:[a.jsx("h2",{className:"text-2xl font-semibold text-white",children:"Escalas cadastradas"}),a.jsx("p",{className:"text-sm text-sky-100/80",children:"Organizadas por ano. Publique quando estiver tudo validado com as lideran\xc3\xa7as."})]}),(0,a.jsxs)("div",{className:"mt-6 space-y-8",children:[0===Object.keys(f).length&&a.jsx("div",{className:"rounded-2xl border border-white/10 bg-white/10 p-6 text-sm text-sky-100/70",children:"Ainda n\xc3\xa3o existe nenhuma escala. Gere a primeira usando o formul\xc3\xa1rio acima. \xf0Ÿ™Œ"}),Object.entries(f).sort(([e],[s])=>Number(s)-Number(e)).map(([e,s])=>(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("h3",{className:"text-lg font-semibold text-white",children:["Ano ",e]}),a.jsx("div",{className:"grid gap-4 md:grid-cols-2",children:s.slice().sort((e,s)=>s.month-e.month).map(e=>{let s=`${String(e.month).padStart(2,"0")}/${e.year}`,t=o[e.status]??"bg-white/10 text-slate-100 border-white/20";return(0,a.jsxs)("article",{className:"flex flex-col gap-4 rounded-2xl border border-white/10 bg-slate-900/50 p-6 shadow-inner shadow-black/40 transition hover:border-indigo-200/40",children:[(0,a.jsxs)("header",{className:"flex flex-col gap-2",children:[a.jsx("p",{className:"text-xs uppercase tracking-widest text-sky-200/70",children:"Escala mensal"}),(0,a.jsxs)("div",{className:"flex flex-wrap items-center gap-3",children:[a.jsx("h4",{className:"text-xl font-semibold text-white",children:s}),a.jsx("span",{className:`rounded-full border px-3 py-1 text-xs font-semibold uppercase tracking-wide ${t}`,children:"published"===e.status?"Publicada":"Rascunho"})]})]}),(0,a.jsxs)("div",{className:"flex flex-wrap gap-3 text-xs text-sky-100/70",children:[(0,a.jsxs)("span",{className:"rounded-full border border-white/10 bg-white/5 px-3 py-1",children:["ID \xc2\xb7 ",e.id.slice(0,8).toUpperCase()]}),(0,a.jsxs)("span",{className:"rounded-full border border-white/10 bg-white/5 px-3 py-1",children:["\xf0Ÿ“… Refer\xc3\xaancia \xc2\xb7 ",s]})]}),(0,a.jsxs)("footer",{className:"mt-2 flex flex-wrap items-center gap-3",children:["draft"===e.status&&a.jsx("button",{type:"button",onClick:()=>publish(e.id),disabled:x===e.id,className:"inline-flex items-center gap-2 rounded-full border border-emerald-300/40 bg-emerald-500/80 px-4 py-2 text-sm font-semibold text-white shadow-lg shadow-emerald-900/30 transition hover:bg-emerald-400 disabled:cursor-not-allowed disabled:border-white/10 disabled:bg-white/10 disabled:text-emerald-100/60",children:x===e.id?"Publicando...":"\xf0Ÿš€ Publicar escala"}),a.jsx("a",{href:`/api/schedules/${e.id}?format=csv`,className:"inline-flex items-center gap-2 rounded-full border border-white/10 bg-white/10 px-4 py-2 text-sm font-semibold text-sky-100 transition hover:bg-white/20",children:"\xf0Ÿ“„ Exportar CSV"}),a.jsx("a",{href:`/api/schedules/${e.id}?format=pdf`,className:"inline-flex items-center gap-2 rounded-full border border-white/10 bg-white/10 px-4 py-2 text-sm font-semibold text-sky-100 transition hover:bg-white/20",children:"\xf0Ÿ–\xa8\xef\xb8\x8f Exportar PDF"})]})]},e.id)})})]},e))]})]})]})})}},6568:(e,s,t)=>{"use strict";t.d(s,{O:()=>r});var a=t(3334);let r=(0,a.createBrowserSupabaseClient)()},6793:(e,s,t)=>{"use strict";t.r(s),t.d(s,{$$typeof:()=>i,__esModule:()=>l,default:()=>o});var a=t(5153);let r=(0,a.createProxy)(String.raw`C:\Users\tribeiro\Documents\church-schedule-app\church-schedule-app\app\dashboard\schedules\page.tsx`),{__esModule:l,$$typeof:i}=r,d=r.default,o=d},1440:(e,s,t)=>{e.exports=t(614)}};var s=require("../../../webpack-runtime.js");s.C(e);var __webpack_exec__=e=>s(s.s=e),t=s.X(0,[657,962,585,614,594],()=>__webpack_exec__(7327));module.exports=t})();